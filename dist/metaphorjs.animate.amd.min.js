define("metaphorjs-animate",function(){function n(b){return"function"==typeof b}function w(b){if(!b)return!1;var e;if("object"!=(e=typeof b)&&"function"!=e)return!1;b=b.then;return n(b)?b:!1}function C(b){return"object"==typeof b&&3===E(b)&&!b.nodeType&&b.constructor===Object}function H(b){return!0===b||!1===b}function B(){var b=!1,e=!1,f;if((f=arguments)&&void 0!=!f.length&&f!==""+f){for(var h=[],g=-1,k=f.length>>>0;++g!==k;h[g]=f[g]);f=h}else f=f?[f]:[];h=f.shift();var d,a;H(f[f.length-1])&&(b=
f.pop());H(f[f.length-1])&&(e=b,b=f.pop());for(;g=f.shift();)for(d in g)if(g.hasOwnProperty(d)&&void 0!==(a=g[d]))if(e)if(h[d]&&C(h[d])&&C(a))B(h[d],a,b,e);else{if(!0===b||void 0==h[d])C(a)?(h[d]={},B(h[d],a,b,!0)):h[d]=a}else if(!0===b||void 0==h[d])h[d]=a;return h}function F(b){return"string"===typeof b||b===""+b}function K(b,e,f,h){return setTimeout(function(){b.apply(e,f||[])},h||0)}var r=r||{};var L=r.getPrefixes=function(){var b=["Moz","Webkit","ms","O","Khtml"],e="animationDelay",f="animationDuration",
h="transitionDelay",g="transitionDuration",k="transform",d=null,a=null,c=!1;return function(){if(!c){var p=window.document.createElement("div"),l=!1,q;if(void 0!==p.style.animationName)l=!0;else{var A=0;for(q=b.length;A<q;A++){var m=b[A];if(void 0!==p.style[m+"AnimationName"]){l=!0;e=m+"AnimationDelay";f=m+"AnimationDuration";h=m+"TransitionDelay";g=m+"TransitionDuration";k=m+"Transform";break}}}l&&("ontransitionend"in window?d="transitionend":"onwebkittransitionend"in window&&(d="webkitTransitionEnd"));
a=l?{animationDelay:e,animationDuration:f,transitionDelay:h,transitionDuration:g,transform:k,transitionend:d}:{};c=!0}return a}}(),M=r.getDuration=function(){var b=function(a){if(!a)return 0;var c=parseFloat(a);-1===a.indexOf("ms")&&(c*=1E3);return c},e=function(a,c,d){var e,f=c.length;for(e=0;e<f;e++){var p=b(c[e])+b(d[e]);a=Math.max(p,a)}return a},f=!1,h=null,g=null,k=null,d=null;return function(a){!1===f&&(h=(f=r.getPrefixes())?f.animationDuration:null,g=f?f.animationDelay:null,k=f?f.transitionDuration:
null,d=f?f.transitionDelay:null);if(!f)return 0;var c=window.getComputedStyle?window.getComputedStyle(a,null):a.style;a=0;var b=(c[h]||"").split(","),l=(c[g]||"").split(","),q=(c[k]||"").split(",");c=(c[d]||"").split(",");a=Math.max(a,e(a,b,l));return a=Math.max(a,e(a,q,c))}}(),N=r.isCssSupported=function(){var b=null;return function(){null===b&&(b=!!L());return b}}(),O=Object.prototype.toString,E=function(){var b={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,
"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(e){if(!e){if(null===e)return 6;if(void 0===e)return 7}var f=b[O.call(e)];return void 0===f?-1:1===f&&isNaN(e)?8:f}}(),P=function(){var b=["0","0","0"];return function(){for(var e=b.length,f;e;){e--;f=b[e].charCodeAt(0);if(57==f)return b[e]="A",b.join("");if(90==f)b[e]="0";else return b[e]=String.fromCharCode(f+1),b.join("")}b.unshift("0");return b.join("")}}(),v=function(){var b={};return function(e,f,h){e=e._mjsid||(e._mjsid=
P());var g=b[e];return void 0!==h?(g||(g=b[e]={}),g[f]=h):g?g[f]:void 0}}(),y=function(){var b=[],e=function(e){var f;var g=0;for(f=b.length;g<f;g++)b[g][0].call(b[g][1],e);"undefined"!=typeof console&&console.error&&console.error(e)};e.on=function(f,h){e.un(f,h);b.push([f,h])};e.un=function(e,h){var f;var k=0;for(f=b.length;k<f;k++)if(b[k][0]===e&&b[k][1]===h){b.splice(k,1);break}};return e}(),G=function(){var b=[],e=!1,f="undefined"!==typeof process?process.nextTick:function(a){setTimeout(a,0)},
h=function(){e=!0;var a=b.shift();f(function(){a[0].apply(a[1],a[2]);b.length?h():e=!1},0)},g=function(a,c,d){d=d||[];b.push([a,c,d]);e||h()},k=function(a,c){return function(d){try{c.resolve(a(d))}catch(l){c.reject(l)}}},d=function(a,c){if(a instanceof d)return a;if(!(this instanceof d))return new d(a,c);var b;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(b=w(a))a instanceof d?a.then(this.resolve.bind(this),this.reject.bind(this)):(new d(b,a)).then(this.resolve.bind(this),
this.reject.bind(this));else if(n(a))try{a.call(c,this.resolve.bind(this),this.reject.bind(this))}catch(l){this.reject(l)}else this.resolve(a)};B(d.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0===this._state},isFulfilled:function(){return 1===this._state},isResolved:function(){return 1===this._state},isRejected:function(){return 2===this._state},hasListeners:function(){var a=[this._fulfills,this._rejects,
this._dones,this._fails],c;var d=0;for(c=a.length;d<c;d++)if(a[d]&&a[d].length)return!0;return!1},_cleanup:function(){this._fails=this._dones=this._rejects=this._fulfills=null},_processValue:function(a,c,b){var e;if(0===this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{if(b)try{if(e=w(a)){a instanceof d?a.then(this._processResolveValue.bind(this),this._processRejectReason.bind(this)):(new d(e,a)).then(this._processResolveValue.bind(this),this._processRejectReason.bind(this));
return}}catch(q){0===this._state&&this._doReject(q);return}c.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,c;c=a.shift();)g(c[0],c[1],[this._value]);this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0===this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,this._doResolve,!0)},resolve:function(a){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(a);return this},_callRejectHandlers:function(){this._fail();
for(var a=this._rejects,c;c=a.shift();)g(c[0],c[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0===this._wait&&this._callRejectHandlers()},_processRejectReason:function(a){this._processValue(a,this._doReject,!1)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);return this},then:function(a,c,b){var e=new d,f=this._state;b&&(a&&(a=a.bind(b)),c&&(c=c.bind(b)));0===f||0!==this._wait?(a&&n(a)?this._fulfills.push([k(a,
e),null]):this._fulfills.push([e.resolve,e]),c&&n(c)?this._rejects.push([k(c,e),null]):this._rejects.push([e.reject,e])):1===f?a&&n(a)?g(k(a,e),null,[this._value]):e.resolve(this._value):2===f&&(c&&n(c)?g(k(c,e),null,[this._reason]):e.reject(this._reason));return e},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,c;c=a.shift();)try{c[0].call(c[1]||null,this._value)}catch(p){y(p)}},done:function(a,c){var d=this._state;if(1===d&&0===this._wait)try{a.call(c||null,
this._value)}catch(l){y(l)}else 0===d&&this._dones.push([a,c]);return this},_fail:function(){for(var a=this._fails,c;c=a.shift();)try{c[0].call(c[1]||null,this._reason)}catch(p){y(p)}},fail:function(a,c){var d=this._state;if(2===d&&0===this._wait)try{a.call(c||null,this._reason)}catch(l){y(l)}else 0===d&&this._fails.push([a,c]);return this},always:function(a,c){this.done(a,c);this.fail(a,c);return this},promise:function(){return{then:this.then.bind(this),done:this.done.bind(this),fail:this.fail.bind(this),
always:this.always.bind(this),"catch":this["catch"].bind(this)}},after:function(a){var c=this;if(w(a)){c._wait++;var d=function(){c._wait--;0===c._wait&&0!==c._state&&(1===c._state?c._callResolveHandlers():c._callRejectHandlers())};n(a.done)?a.done(d):a.then(d)}return c}},!0,!1);d.fcall=function(a,c,b){return d.resolve(a.apply(c,b||[]))};d.resolve=function(a){var c=new d;c.resolve(a);return c};d.reject=function(a){var c=new d;c.reject(a);return c};d.all=function(a){if(!a.length)return d.resolve(null);
var c=new d,b=a.length,e=Array(b),f=b,h,k,g=function(a,d){e[d]=a;f--;0===f&&c.resolve(e)};for(h=0;h<b;h++)(function(b){k=a[h];k instanceof d?k.done(function(a){g(a,b)}).fail(c.reject,c):w(k)||n(k)?(new d(k)).done(function(a){g(a,b)}).fail(c.reject,c):g(k,b)})(h);return c};d.when=function(){return d.all(arguments)};d.allResolved=function(a){if(!a.length)return d.resolve(null);var c=new d,b=a.length,e=[],f=b,h,k=function(a){e.push(a);g()},g=function(){f--;0===f&&c.resolve(e)};for(h=0;h<b;h++){var t=
a[h];t instanceof d?t.done(k).fail(g):w(t)||n(t)?(new d(t)).done(k).fail(g):k(t)}return c};d.race=function(a){if(!a.length)return d.resolve(null);var c=new d,b=a.length,e;for(e=0;e<b;e++){var f=a[e];f instanceof d?f.done(c.resolve,c).fail(c.reject,c):w(f)||n(f)?(new d(f)).done(c.resolve,c).fail(c.reject,c):c.resolve(f);if(!c.isPending())break}return c};d.waterfall=function(a){if(!a.length)return d.resolve(null);var c=a.shift();c=n(c)?d.fcall(c):d.resolve(b);for(var b;b=a.shift();)w(b)?c=c.then(function(a){return function(){return a}}(b)):
n(b)?c=c.then(b):c.resolve(b);return c};d.forEach=function(a,c,b,e){var f=a.slice(),h=new d,k=[],g=0,l=function(){if(f.length){var a=f.shift(),m=g;g++;d.fcall(c,b,[a,m]).done(function(a){k.push(a);l()}).fail(function(a){e?h.reject(a):(k.push(null),l())})}else h.resolve(k)};l();return h};d.counter=function(a){var c=new d;c.countdown=function(){a--;0===a&&c.resolve()};return c};return d}(),Q=function(){var b,e=function(e){var f={},g=[];0==arguments.length&&(e=!0);return{addFinder:function(b,d,a){g[a?
"unshift":"push"]({fn:b,context:d})},add:function(b,d,a){if(f[b]&&!1===f[b].rewritable)return f[b];f[b]={rewritable:"undefined"!=typeof a?a:e,value:d};return d},get:function(b,d){if(f[b])return f[b].value;if(g.length){var a;var c=0;for(a=g.length;c<a;c++){var e=g[c].fn.call(g[c].context,b,this);if(void 0!==e)return this.add(b,e,!0)}}if(void 0!==d)return this.add(b,d)},remove:function(b){var d=f[b];d&&!0===d.rewritable&&delete f[b];return d?d.value:void 0},exists:function(b){return!!f[b]},eachEntry:function(b,
d){for(var a in f)b.call(d,f[a].value,a)},clear:function(){f={}},$destroy:function(){this===b&&(b=null);this.remove=this.exists=this.destroy=this.get=this.add=e=f=null}}};e.global=function(){b||(b=new e(!0));return b};return e}(),I=function(b){b="(?:^|\\s)"+b+"(?!\\S)";var e=Q.global(),f="regex_"+b;return e.get(f)||e.add(f,new RegExp(b))},J=function(b,e){var f;if(f=e)f=!(e&&I(e).test(b.className));f&&(b.className+=" "+e)},D=function(b,e){e&&(b.className=b.className.replace(I(e),""))},z=function(){if("undefined"!==
typeof window){var b=window;var e=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame;var f=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.mozCancelAnimationFrame||b.webkitCancelRequestAnimationFrame;if(e)return function(b,g,k){var d=e(g||k?function(){b.apply(g,k||[])}:b);return function(){f(d)}}}return function(b,e,f){var d=K(b,e,f,0);return function(){clearTimeout(d)}}}();r.animate=function(){var b={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],
leave:["mjs-leave"],move:["mjs-move"]},e=0,f=function(b,d,a){var c=function(){(new Date).getTime()-d>=a?b():z(c)};z(c)},h=function u(b,a,c,e,g,n,A,m){var d=function(){var a=v(b,"mjsAnimationQueue");return a&&a.length&&a[0].id==A?!1:(g.reject(b),!0)},l=function(){if(!d()){var e=c;c++;if(c===a.length){g.resolve(b);v(b,"mjsAnimationQueue").shift();var f=v(b,"mjsAnimationQueue");f.length?(f=f[0],h(f.el,f.stages,0,f.start,f.deferred,!1,f.id,f.step)):v(b,"mjsAnimationQueue",null)}else v(b,"mjsAnimationQueue")[0].position=
c,u(b,a,c,null,g,!1,A,m);D(b,a[e]);D(b,a[e]+"-active")}},p=function(){d()||(J(b,a[c]+"-active"),G.resolve(m&&m(b,c,"active")).done(function(){if(!d()){var a=M(b);a?f(l,(new Date).getTime(),a):z(l)}}))},q=function(){d()||(J(b,a[c]),G.waterfall([m&&m(b,c,"start"),function(){return e?e(b):null}]).done(function(){!d()&&z(p)}))};n?z(q):q()},g=function(d,a,c,f){var g=new G,q=v(d,"mjsAnimationQueue")||[],p=++e;if(a){if(F(a))var m=b[a];else if(n(a))var u=a;else if("object"===typeof a&&5===E(a))if(F(a[0]))m=
a;else{var t=a[0];var r=a[1]}if(C(a)){m=a.stages;u=a.fn;t=a.before;r=a.after;var x=a.options?B({},a.options):{};var z=a.context||null;var y=a.duration||null;c=c||x.start}if(N()&&m)return q.push({el:d,stages:m,start:c,step:f,deferred:g,position:0,id:p}),v(d,"mjsAnimationQueue",q),1===q.length&&h(d,m,0,c,g,!0,p,f),g;x=x||{};c&&(x.start=function(){c(d)});x.complete=function(){g.resolve(d)};y&&(x.duration=y);if(u&&n(u))return t&&B(d.style,t,!0,!1),c&&c(d),v(d,"mjsAnimationQueue",u.call(z,d,function(){g.resolve(d)})),
g;if(window.jQuery){a=$(d);t&&a.css(t);v(d,"mjsAnimationQueue","stop");if(u&&F(u))return a[u](x),g;if(r)return a.animate(r,x),g}}c?(u=c(d),w(u)?u.done(function(){g.resolve(d)}):g.resolve(d)):g.resolve(d);return g};g.addAnimationType=function(d,a){b[d]=a};return g}();r.stop=function(b){var e=v(b,"mjsAnimationQueue");if("object"===typeof e&&5===E(e)&&e.length){if(e=e[0]){if(e.stages){var f=e.position;var h=e.stages;D(b,h[f]);D(b,h[f]+"-active")}e.deferred&&e.deferred.reject(e.el)}}else n(e)?e(b):"stop"===
e&&$(b).stop(!0,!0);v(b,"mjsAnimationQueue",null)};return r});
