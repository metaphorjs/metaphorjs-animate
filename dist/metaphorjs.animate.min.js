(function(){function w(d,b){b&&(d.className=d.className.replace(I("(?:^|\\s)"+b+"(?!\\S)"),""))}function p(d){return"function"==typeof d}function x(d){if(!d)return!1;var b,e;return"object"!=(e=typeof d)&&"function"!=e?!1:p(b=d.then)?b:!1}function B(d){return"object"==typeof d&&3===C(d)&&!d.nodeType&&d.constructor===Object}function J(d){return!0===d||!1===d}function N(d,b,e,m){return setTimeout(function(){d.apply(b,e||[])},m||0)}function K(d,b){var e;if(e=b)e=!(b&&I("(?:^|\\s)"+b+"(?!\\S)").test(d.className));
e&&(d.className+=" "+b)}function D(d){return"string"==typeof d||d===""+d}var F=function(){var d=["Moz","Webkit","ms","O","Khtml"],b="animationDelay",e="animationDuration",m="transitionDelay",f="transitionDuration",k="transform",g=null,a=null,c=!1;return function(){if(!c){var h=window.document.createElement("div"),l=!1,r;if(void 0!==h.style.animationName)l=!0;else{var E=0;for(r=d.length;E<r;E++){var q=d[E];if(void 0!==h.style[q+"AnimationName"]){l=!0;b=q+"AnimationDelay";e=q+"AnimationDuration";m=
q+"TransitionDelay";f=q+"TransitionDuration";k=q+"Transform";break}}}l&&("ontransitionend"in window?g="transitionend":"onwebkittransitionend"in window&&(g="webkitTransitionEnd"));a=l?{animationDelay:b,animationDuration:e,transitionDelay:m,transitionDuration:f,transform:k,transitionend:g}:{};c=!0}return a}}(),L=function(){var d=function(a){if(!a)return 0;var c=parseFloat(a);-1===a.indexOf("ms")&&(c*=1E3);return c},b=function(a,c,h){var l,b=c.length;for(l=0;l<b;l++){var e=d(c[l])+d(h[l]);a=Math.max(e,
a)}return a},e=!1,m=null,f=null,k=null,g=null;return function(a){!1===e&&(m=(e=F())?e.animationDuration:null,f=e?e.animationDelay:null,k=e?e.transitionDuration:null,g=e?e.transitionDelay:null);if(!e)return 0;var c=window.getComputedStyle?window.getComputedStyle(a,null):a.style;a=0;var h=(c[m]||"").split(","),d=(c[f]||"").split(","),r=(c[k]||"").split(",");c=(c[g]||"").split(",");a=Math.max(a,b(a,h,d));return a=Math.max(a,b(a,r,c))}}(),O=function(){var d=["0","0","0"];return function(){for(var b=d.length,
e;b;){b--;e=d[b].charCodeAt(0);if(57==e)return d[b]="A",d.join("");if(90==e)d[b]="0";else return d[b]=String.fromCharCode(e+1),d.join("")}d.unshift("0");return d.join("")}}(),u=function(){var d={};return function(b,e,m){b=b._mjsid||(b._mjsid=O());var f=d[b];return void 0!==m?(f||(f=d[b]={}),f[e]=m):f?f[e]:void 0}}(),I=function(){var d={};return function(b){return d[b]||(d[b]=new RegExp(b))}}(),P=Object.prototype.toString,C=function(){var d={"[object String]":0,"[object Number]":1,"[object Boolean]":2,
"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(b){if(!b){if(null===b)return 6;if(void 0===b)return 7}var e=d[P.call(b)];return void 0===e?-1:1===e&&isNaN(b)?8:e}}(),M=function(d){var b=u(d,"mjsAnimationQueue");if("object"===typeof b&&5===C(b)&&b.length){if(b=b[0]){if(b.stages){var e=b.position;var m=b.stages;w(d,m[e]);w(d,m[e]+"-active")}b.deferred&&b.deferred.reject(b.el)}}else p(b)?b(d):"stop"===b&&$(d).stop(!0,!0);u(d,"mjsAnimationQueue",
null)},Q=Array.prototype.slice,G=function(){return function b(){var e=!1,m=!1,f=Q.call(arguments),k=f.shift(),g,a,c;J(f[f.length-1])&&(e=f.pop());J(f[f.length-1])&&(m=e,e=f.pop());for(;f.length;)if((g=f.shift())&&g.hasOwnProperty)for(a in g)if(g.hasOwnProperty(a)&&void 0!==(c=g[a]))if(m)if(k[a]&&B(k[a])&&B(c))b(k[a],c,e,m);else{if(!0===e||void 0==k[a])B(c)?(k[a]={},b(k[a],c,e,!0)):k[a]=c}else if(!0===e||void 0==k[a])k[a]=c;return k}}(),n=Function.prototype.bind?function(d,b){return d.bind(b)}:function(d,
b){return function(){return d.apply(b,arguments)}},A=function(){var d=[],b=function(b){var e;var f=0;for(e=d.length;f<e;f++)if(!1===d[f][0].call(d[f][1],b))return;f=(b?b.stack:null)||Error().stack;if("undefined"!=typeof console&&console.error)b&&console.error(b),f&&console.error(f);else throw b;};b.on=function(e,m){b.un(e,m);d.push([e,m])};b.un=function(b,m){var e;var k=0;for(e=d.length;k<e;k++)if(d[k][0]===b&&d[k][1]===m){d.splice(k,1);break}};return b}(),H=function(){var d=[],b=!1,e="undefined"!==
typeof process?process.nextTick:function(a){setTimeout(a,0)},m=function(){b=!0;var a=d.shift();e(function(){a[0].apply(a[1],a[2]);d.length?m():b=!1},0)},f=function(a,c,h){h=h||[];d.push([a,c,h]);b||m()},k=function(a,c){return function(h){try{c.resolve(a(h))}catch(l){c.reject(l)}}},g=function(a,c){if(a instanceof g)return a;if(!(this instanceof g))return new g(a,c);var h;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(h=x(a))a instanceof g?a.then(n(this.resolve,
this),n(this.reject,this)):(new g(h,a)).then(n(this.resolve,this),n(this.reject,this));else if(p(a))try{a.call(c,n(this.resolve,this),n(this.reject,this))}catch(l){this.reject(l)}else this.resolve(a)};G(g.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0===this._state},isFulfilled:function(){return 1===this._state},isResolved:function(){return 1===this._state},isRejected:function(){return 2===this._state},
hasListeners:function(){var a=[this._fulfills,this._rejects,this._dones,this._fails],c;var h=0;for(c=a.length;h<c;h++)if(a[h]&&a[h].length)return!0;return!1},_cleanup:function(){this._fails=this._dones=this._rejects=this._fulfills=null},_processValue:function(a,c){var h;if(0===this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(h=x(a)){a instanceof g?a.then(n(this._processResolveValue,this),n(this._processRejectReason,this)):(new g(h,a)).then(n(this._processResolveValue,
this),n(this._processRejectReason,this));return}}catch(l){0===this._state&&this._doReject(l);return}c.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,c;c=a.shift();)f(c[0],c[1],[this._value]);this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0===this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,this._doResolve)},resolve:function(a){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(a);
return this},_callRejectHandlers:function(){this._fail();for(var a=this._rejects,c;c=a.shift();)f(c[0],c[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0===this._wait&&this._callRejectHandlers()},_processRejectReason:function(a){this._processValue(a,this._doReject)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);return this},then:function(a,c,h){var b=new g,d=this._state;h&&(a&&(a=n(a,h)),c&&(c=n(c,h)));0===
d||0!==this._wait?(a&&p(a)?this._fulfills.push([k(a,b),null]):this._fulfills.push([b.resolve,b]),c&&p(c)?this._rejects.push([k(c,b),null]):this._rejects.push([b.reject,b])):1===d?a&&p(a)?f(k(a,b),null,[this._value]):b.resolve(this._value):2===d&&(c&&p(c)?f(k(c,b),null,[this._reason]):b.reject(this._reason));return b},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,c;c=a.shift();)try{c[0].call(c[1]||null,this._value)}catch(h){A(h)}},done:function(a,c){var b=this._state;
if(1===b&&0===this._wait)try{a.call(c||null,this._value)}catch(l){A(l)}else 0===b&&this._dones.push([a,c]);return this},_fail:function(){for(var a=this._fails,c;c=a.shift();)try{c[0].call(c[1]||null,this._reason)}catch(h){A(h)}},fail:function(a,c){var b=this._state;if(2===b&&0===this._wait)try{a.call(c||null,this._reason)}catch(l){A(l)}else 0===b&&this._fails.push([a,c]);return this},always:function(a,c){this.done(a,c);this.fail(a,c);return this},promise:function(){return{then:n(this.then,this),done:n(this.done,
this),fail:n(this.fail,this),always:n(this.always,this)}},after:function(a){var c=this;if(x(a)){c._wait++;var b=function(){c._wait--;0===c._wait&&0!==c._state&&(1===c._state?c._callResolveHandlers():c._callRejectHandlers())};p(a.done)?a.done(b):a.then(b)}return c}},!0,!1);g.fcall=function(a,c,b){return g.resolve(a.apply(c,b||[]))};g.resolve=function(a){var c=new g;c.resolve(a);return c};g.reject=function(a){var c=new g;c.reject(a);return c};g.all=function(a){if(!a.length)return g.resolve(null);var c=
new g,b=a.length,d=Array(b),e=b,f,q,k=function(a,b){d[b]=a;e--;0===e&&c.resolve(d)};for(f=0;f<b;f++)(function(b){q=a[f];q instanceof g?q.done(function(a){k(a,b)}).fail(c.reject,c):x(q)||p(q)?(new g(q)).done(function(a){k(a,b)}).fail(c.reject,c):k(q,b)})(f);return c};g.when=function(){return g.all(arguments)};g.allResolved=function(a){if(!a.length)return g.resolve(null);var c=new g,b=a.length,d=[],e=b,f,k=function(a){d.push(a);m()},m=function(){e--;0===e&&c.resolve(d)};for(f=0;f<b;f++){var n=a[f];
n instanceof g?n.done(k).fail(m):x(n)||p(n)?(new g(n)).done(k).fail(m):k(n)}return c};g.race=function(a){if(!a.length)return g.resolve(null);var c=new g,b=a.length,d;for(d=0;d<b;d++){var e=a[d];e instanceof g?e.done(c.resolve,c).fail(c.reject,c):x(e)||p(e)?(new g(e)).done(c.resolve,c).fail(c.reject,c):c.resolve(e);if(!c.isPending())break}return c};g.waterfall=function(a){if(!a.length)return g.resolve(null);var c=a.shift();c=p(c)?g.fcall(c):g.resolve(b);for(var b;b=a.shift();)x(b)?c=c.then(function(a){return function(){return a}}(b)):
p(b)?c=c.then(b):c.resolve(b);return c};g.forEach=function(a,b,d,e){var c=a.slice(),h=new g,l=[],f=0,k=function(){if(c.length){var a=c.shift(),m=f;f++;g.fcall(b,d,[a,m]).done(function(a){l.push(a);k()}).fail(function(a){e?h.reject(a):(l.push(null),k())})}else h.resolve(l)};k();return h};g.counter=function(a){var b=new g;b.countdown=function(){a--;0===a&&b.resolve()};return b};return g}(),v=function(){if("undefined"!==typeof window){var d=window;var b=d.requestAnimationFrame||d.webkitRequestAnimationFrame||
d.mozRequestAnimationFrame;var e=d.cancelAnimationFrame||d.webkitCancelAnimationFrame||d.mozCancelAnimationFrame||d.webkitCancelRequestAnimationFrame;if(b)return function(d,f,k){var g=b(f||k?function(){d.apply(f,k||[])}:d);return function(){e(g)}}}return function(b,d,e){var g=N(b,d,e,0);return function(){clearTimeout(g)}}}(),R=function(){var d={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},b=0,e=!1,m=!1,f=function(a,b,d){var c=function(){(new Date).getTime()-
b>=d?a():v(c)};v(c)},k=function(){!1===e&&(e=F(),m=!!e);return m},g=function t(a,b,d,e,k,m,n,p){var h=function(){var b=u(a,"mjsAnimationQueue");return b&&b.length&&b[0].id==n?!1:(k.reject(a),!0)},l=function(){if(!h()){var e=d;d++;if(d===b.length){k.resolve(a);u(a,"mjsAnimationQueue").shift();var l=u(a,"mjsAnimationQueue");l.length?(l=l[0],g(l.el,l.stages,0,l.start,l.deferred,!1,l.id,l.step)):u(a,"mjsAnimationQueue",null)}else u(a,"mjsAnimationQueue")[0].position=d,t(a,b,d,null,k,!1,n,p);w(a,b[e]);
w(a,b[e]+"-active")}},q=function(){h()||(K(a,b[d]+"-active"),H.resolve(p&&p(a,d,"active")).done(function(){if(!h()){var b=L(a);b?f(l,(new Date).getTime(),b):v(l)}}))},r=function(){h()||(K(a,b[d]),H.waterfall([p&&p(a,d,"start"),function(){return e?e(a):null}]).done(function(){!h()&&v(q)}))};m?v(r):r()},a=function(a,e,f,m){var h=new H,l=u(a,"mjsAnimationQueue")||[],n=++b;if(e){if(D(e))var r=d[e];else if(p(e))var t=e;else if("object"===typeof e&&5===C(e))if(D(e[0]))r=e;else{var v=e[0];var w=e[1]}if(B(e)){r=
e.stages;t=e.fn;v=e.before;w=e.after;var y=e.options?G({},e.options):{};var A=e.context||null;var z=e.duration||null;f=f||y.start}if(k()&&r)return l.push({el:a,stages:r,start:f,step:m,deferred:h,position:0,id:n}),u(a,"mjsAnimationQueue",l),1===l.length&&g(a,r,0,f,h,!0,n,m),h;y=y||{};f&&(y.start=function(){f(a)});y.complete=function(){h.resolve(a)};z&&(y.duration=z);if(t&&p(t))return v&&G(a.style,v,!0,!1),f&&f(a),u(a,"mjsAnimationQueue",t.call(A,a,function(){h.resolve(a)})),h;if(window.jQuery){e=$(a);
v&&e.css(v);u(a,"mjsAnimationQueue","stop");if(t&&D(t))return e[t](y),h;if(w)return e.animate(w,y),h}}f?(t=f(a),x(t)?t.done(function(){h.resolve(a)}):h.resolve(a)):h.resolve(a);return h};a.addAnimationType=function(a,b){d[a]=b};a.stop=M;a.getPrefixes=F;a.getDuration=L;a.cssAnimationSupported=k;return a}(),z={};z.animate=R;z.stopAnimation=M;"undefined"!=typeof global?global.MetaphorJs=z:window.MetaphorJs=z})();
