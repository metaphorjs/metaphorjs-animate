(function(){function n(b){return"function"==typeof b}function x(b){if(!b)return!1;var d;if("object"!=(d=typeof b)&&"function"!=d)return!1;b=b.then;return n(b)?b:!1}function C(b){return"object"==typeof b&&3===D(b)&&!b.nodeType&&b.constructor===Object}function H(b){return!0===b||!1===b}function B(){var b=!1,d=!1,f;if((f=arguments)&&void 0!=!f.length&&f!==""+f){for(var h=[],g=-1,k=f.length>>>0;++g!==k;h[g]=f[g]);f=h}else f=f?[f]:[];h=f.shift();var e,a;H(f[f.length-1])&&(b=f.pop());H(f[f.length-1])&&
(d=b,b=f.pop());for(;g=f.shift();)for(e in g)if(g.hasOwnProperty(e)&&void 0!==(a=g[e]))if(d)if(h[e]&&C(h[e])&&C(a))B(h[e],a,b,d);else{if(!0===b||void 0==h[e])C(a)?(h[e]={},B(h[e],a,b,!0)):h[e]=a}else if(!0===b||void 0==h[e])h[e]=a;return h}function E(b){return"string"===typeof b||b===""+b}function K(b,d,f,h){return setTimeout(function(){b.apply(d,f||[])},h||0)}var l={plugin:{},mixin:{},lib:{}};l.animate=l.animate||{};var L=l.animate.getPrefixes=function(){var b=["Moz","Webkit","ms","O","Khtml"],d=
"animationDelay",f="animationDuration",h="transitionDelay",g="transitionDuration",k="transform",e=null,a=null,c=!1;return function(){if(!c){var q=window.document.createElement("div"),m=!1,v;if(void 0!==q.style.animationName)m=!0;else{var F=0;for(v=b.length;F<v;F++){var p=b[F];if(void 0!==q.style[p+"AnimationName"]){m=!0;d=p+"AnimationDelay";f=p+"AnimationDuration";h=p+"TransitionDelay";g=p+"TransitionDuration";k=p+"Transform";break}}}m&&("ontransitionend"in window?e="transitionend":"onwebkittransitionend"in
window&&(e="webkitTransitionEnd"));a=m?{animationDelay:d,animationDuration:f,transitionDelay:h,transitionDuration:g,transform:k,transitionend:e}:{};c=!0}return a}}(),M=l.animate.getDuration=function(){var b=function(a){if(!a)return 0;var c=parseFloat(a);-1===a.indexOf("ms")&&(c*=1E3);return c},d=function(a,c,e){var d,f=c.length;for(d=0;d<f;d++){var q=b(c[d])+b(e[d]);a=Math.max(q,a)}return a},f=!1,h=null,g=null,k=null,e=null;return function(a){!1===f&&(h=(f=l.animate.getPrefixes())?f.animationDuration:
null,g=f?f.animationDelay:null,k=f?f.transitionDuration:null,e=f?f.transitionDelay:null);if(!f)return 0;var c=window.getComputedStyle?window.getComputedStyle(a,null):a.style;a=0;var b=(c[h]||"").split(","),m=(c[g]||"").split(","),v=(c[k]||"").split(",");c=(c[e]||"").split(",");a=Math.max(a,d(a,b,m));return a=Math.max(a,d(a,v,c))}}(),N=l.animate.isCssSupported=function(){var b=null;return function(){null===b&&(b=!!L());return b}}(),O=Object.prototype.toString,D=function(){var b={"[object String]":0,
"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(d){if(!d){if(null===d)return 6;if(void 0===d)return 7}var f=b[O.call(d)];return void 0===f?-1:1===f&&isNaN(d)?8:f}}();l.dom=l.dom||{};var P=function(){var b=["0","0","0"];return function(){for(var d=b.length,f;d;){d--;f=b[d].charCodeAt(0);if(57==f)return b[d]="A",b.join("");if(90==f)b[d]="0";else return b[d]=String.fromCharCode(f+1),b.join("")}b.unshift("0");
return b.join("")}}(),u=l.dom.data=function(){var b={};return function(d,f,h){d=d._mjsid||(d._mjsid=P());var g=b[d];return void 0!==h?(g||(g=b[d]={}),g[f]=h):g?g[f]:void 0}}(),A=function(){var b=[],d=function(d){var f;var g=0;for(f=b.length;g<f;g++)b[g][0].call(b[g][1],d);"undefined"!=typeof console&&console.error&&console.error(d)};d.on=function(f,h){d.un(f,h);b.push([f,h])};d.un=function(d,h){var f;var k=0;for(f=b.length;k<f;k++)if(b[k][0]===d&&b[k][1]===h){b.splice(k,1);break}};return d}(),G=l.lib.Promise=
function(){var b=[],d=!1,f="undefined"!==typeof process?process.nextTick:function(a){setTimeout(a,0)},h=function(){d=!0;var a=b.shift();f(function(){a[0].apply(a[1],a[2]);b.length?h():d=!1},0)},g=function(a,c,e){e=e||[];b.push([a,c,e]);d||h()},k=function(a,c){return function(e){try{c.resolve(a(e))}catch(m){c.reject(m)}}},e=function(a,c){if(a instanceof e)return a;if(!(this instanceof e))return new e(a,c);var b;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(b=
x(a))a instanceof e?a.then(this.resolve.bind(this),this.reject.bind(this)):(new e(b,a)).then(this.resolve.bind(this),this.reject.bind(this));else if(n(a))try{a.call(c,this.resolve.bind(this),this.reject.bind(this))}catch(m){this.reject(m)}else this.resolve(a)};B(e.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0===this._state},isFulfilled:function(){return 1===this._state},isResolved:function(){return 1===
this._state},isRejected:function(){return 2===this._state},hasListeners:function(){var a=[this._fulfills,this._rejects,this._dones,this._fails],c;var e=0;for(c=a.length;e<c;e++)if(a[e]&&a[e].length)return!0;return!1},_cleanup:function(){this._fails=this._dones=this._rejects=this._fulfills=null},_processValue:function(a,c,b){var d;if(0===this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{if(b)try{if(d=x(a)){a instanceof e?a.then(this._processResolveValue.bind(this),
this._processRejectReason.bind(this)):(new e(d,a)).then(this._processResolveValue.bind(this),this._processRejectReason.bind(this));return}}catch(v){0===this._state&&this._doReject(v);return}c.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,c;c=a.shift();)g(c[0],c[1],[this._value]);this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0===this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,this._doResolve,
!0)},resolve:function(a){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(a);return this},_callRejectHandlers:function(){this._fail();for(var a=this._rejects,c;c=a.shift();)g(c[0],c[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0===this._wait&&this._callRejectHandlers()},_processRejectReason:function(a){this._processValue(a,this._doReject,!1)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);
return this},then:function(a,c,b){var d=new e,f=this._state;b&&(a&&(a=a.bind(b)),c&&(c=c.bind(b)));0===f||0!==this._wait?(a&&n(a)?this._fulfills.push([k(a,d),null]):this._fulfills.push([d.resolve,d]),c&&n(c)?this._rejects.push([k(c,d),null]):this._rejects.push([d.reject,d])):1===f?a&&n(a)?g(k(a,d),null,[this._value]):d.resolve(this._value):2===f&&(c&&n(c)?g(k(c,d),null,[this._reason]):d.reject(this._reason));return d},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,
c;c=a.shift();)try{c[0].call(c[1]||null,this._value)}catch(q){A(q)}},done:function(a,c){var e=this._state;if(1===e&&0===this._wait)try{a.call(c||null,this._value)}catch(m){A(m)}else 0===e&&this._dones.push([a,c]);return this},_fail:function(){for(var a=this._fails,c;c=a.shift();)try{c[0].call(c[1]||null,this._reason)}catch(q){A(q)}},fail:function(a,c){var e=this._state;if(2===e&&0===this._wait)try{a.call(c||null,this._reason)}catch(m){A(m)}else 0===e&&this._fails.push([a,c]);return this},always:function(a,
c){this.done(a,c);this.fail(a,c);return this},promise:function(){return{then:this.then.bind(this),done:this.done.bind(this),fail:this.fail.bind(this),always:this.always.bind(this),"catch":this["catch"].bind(this)}},after:function(a){var c=this;if(x(a)){c._wait++;var e=function(){c._wait--;0===c._wait&&0!==c._state&&(1===c._state?c._callResolveHandlers():c._callRejectHandlers())};n(a.done)?a.done(e):a.then(e)}return c}},!0,!1);e.fcall=function(a,c,b){return e.resolve(a.apply(c,b||[]))};e.resolve=function(a){var c=
new e;c.resolve(a);return c};e.reject=function(a){var c=new e;c.reject(a);return c};e.all=function(a){if(!a.length)return e.resolve(null);var c=new e,b=a.length,d=Array(b),f=b,h,k,g=function(a,e){d[e]=a;f--;0===f&&c.resolve(d)};for(h=0;h<b;h++)(function(b){k=a[h];k instanceof e?k.done(function(a){g(a,b)}).fail(c.reject,c):x(k)||n(k)?(new e(k)).done(function(a){g(a,b)}).fail(c.reject,c):g(k,b)})(h);return c};e.when=function(){return e.all(arguments)};e.allResolved=function(a){if(!a.length)return e.resolve(null);
var c=new e,b=a.length,d=[],f=b,h,k=function(a){d.push(a);g()},g=function(){f--;0===f&&c.resolve(d)};for(h=0;h<b;h++){var r=a[h];r instanceof e?r.done(k).fail(g):x(r)||n(r)?(new e(r)).done(k).fail(g):k(r)}return c};e.race=function(a){if(!a.length)return e.resolve(null);var c=new e,b=a.length,d;for(d=0;d<b;d++){var f=a[d];f instanceof e?f.done(c.resolve,c).fail(c.reject,c):x(f)||n(f)?(new e(f)).done(c.resolve,c).fail(c.reject,c):c.resolve(f);if(!c.isPending())break}return c};e.waterfall=function(a){if(!a.length)return e.resolve(null);
var c=a.shift();c=n(c)?e.fcall(c):e.resolve(b);for(var b;b=a.shift();)x(b)?c=c.then(function(a){return function(){return a}}(b)):n(b)?c=c.then(b):c.resolve(b);return c};e.forEach=function(a,c,b,d){var f=a.slice(),h=new e,k=[],g=0,m=function(){if(f.length){var a=f.shift(),l=g;g++;e.fcall(c,b,[a,l]).done(function(a){k.push(a);m()}).fail(function(a){d?h.reject(a):(k.push(null),m())})}else h.resolve(k)};m();return h};e.counter=function(a){var c=new e;c.countdown=function(){a--;0===a&&c.resolve()};return c};
return e}(),Q=l.lib.Cache=function(){var b,d=function(d){var f={},g=[];0==arguments.length&&(d=!0);return{addFinder:function(b,e,a){g[a?"unshift":"push"]({fn:b,context:e})},add:function(b,e,a){if(f[b]&&!1===f[b].rewritable)return f[b];f[b]={rewritable:"undefined"!=typeof a?a:d,value:e};return e},get:function(b,e){if(f[b])return f[b].value;if(g.length){var a;var c=0;for(a=g.length;c<a;c++){var d=g[c].fn.call(g[c].context,b,this);if(void 0!==d)return this.add(b,d,!0)}}if(void 0!==e)return this.add(b,
e)},remove:function(b){var e=f[b];e&&!0===e.rewritable&&delete f[b];return e?e.value:void 0},exists:function(b){return!!f[b]},eachEntry:function(b,e){for(var a in f)b.call(e,f[a].value,a)},clear:function(){f={}},$destroy:function(){this===b&&(b=null);this.remove=this.exists=this.destroy=this.get=this.add=d=f=null}}};d.global=function(){b||(b=new d(!0));return b};return d}(),I=l.dom.getClsReg=function(b){b="(?:^|\\s)"+b+"(?!\\S)";var d=Q.global(),f="regex_"+b;return d.get(f)||d.add(f,new RegExp(b))},
R=l.dom.hasClass=function(b,d){return d?I(d).test(b.className):!1},J=l.dom.addClass=function(b,d){d&&!R(b,d)&&(b.className+=" "+d)},z=l.dom.removeClass=function(b,d){d&&(b.className=b.className.replace(I(d),""))},w=function(){if("undefined"!==typeof window){var b=window;var d=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame;var f=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.mozCancelAnimationFrame||b.webkitCancelRequestAnimationFrame;if(d)return function(b,
g,k){var e=d(g||k?function(){b.apply(g,k||[])}:b);return function(){f(e)}}}return function(b,d,f){var e=K(b,d,f,0);return function(){clearTimeout(e)}}}();l.animate.animate=function(){var b={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},d=0,f=function(b,e,a){var c=function(){(new Date).getTime()-e>=a?b():w(c)};w(c)},h=function t(b,a,c,d,g,l,n,p){var e=function(){var a=u(b,"mjsAnimationQueue");return a&&a.length&&a[0].id==n?!1:(g.reject(b),!0)},m=function(){if(!e()){var d=
c;c++;if(c===a.length){g.resolve(b);u(b,"mjsAnimationQueue").shift();var f=u(b,"mjsAnimationQueue");f.length?(f=f[0],h(f.el,f.stages,0,f.start,f.deferred,!1,f.id,f.step)):u(b,"mjsAnimationQueue",null)}else u(b,"mjsAnimationQueue")[0].position=c,t(b,a,c,null,g,!1,n,p);z(b,a[d]);z(b,a[d]+"-active")}},q=function(){e()||(J(b,a[c]+"-active"),G.resolve(p&&p(b,c,"active")).done(function(){if(!e()){var a=M(b);a?f(m,(new Date).getTime(),a):w(m)}}))},v=function(){e()||(J(b,a[c]),G.waterfall([p&&p(b,c,"start"),
function(){return d?d(b):null}]).done(function(){!e()&&w(q)}))};l?w(v):v()},g=function(e,a,c,f){var g=new G,l=u(e,"mjsAnimationQueue")||[],q=++d;if(a){if(E(a))var p=b[a];else if(n(a))var t=a;else if("object"===typeof a&&5===D(a))if(E(a[0]))p=a;else{var r=a[0];var w=a[1]}if(C(a)){p=a.stages;t=a.fn;r=a.before;w=a.after;var y=a.options?B({},a.options):{};var A=a.context||null;var z=a.duration||null;c=c||y.start}if(N()&&p)return l.push({el:e,stages:p,start:c,step:f,deferred:g,position:0,id:q}),u(e,"mjsAnimationQueue",
l),1===l.length&&h(e,p,0,c,g,!0,q,f),g;y=y||{};c&&(y.start=function(){c(e)});y.complete=function(){g.resolve(e)};z&&(y.duration=z);if(t&&n(t))return r&&B(e.style,r,!0,!1),c&&c(e),u(e,"mjsAnimationQueue",t.call(A,e,function(){g.resolve(e)})),g;if(window.jQuery){a=$(e);r&&a.css(r);u(e,"mjsAnimationQueue","stop");if(t&&E(t))return a[t](y),g;if(w)return a.animate(w,y),g}}c?(t=c(e),x(t)?t.done(function(){g.resolve(e)}):g.resolve(e)):g.resolve(e);return g};g.addAnimationType=function(d,a){b[d]=a};return g}();
l.animate.stop=function(b){var d=u(b,"mjsAnimationQueue");if("object"===typeof d&&5===D(d)&&d.length){if(d=d[0]){if(d.stages){var f=d.position;var h=d.stages;z(b,h[f]);z(b,h[f]+"-active")}d.deferred&&d.deferred.reject(d.el)}}else n(d)?d(b):"stop"===d&&$(b).stop(!0,!0);u(b,"mjsAnimationQueue",null)};"undefined"!=typeof global?global.MetaphorJs=l:window.MetaphorJs=l})();
